#! /usr/bin/env python

import argparse

from commands import settings, upstream
from commands.utils import parse_string


def main():

    parser = argparse.ArgumentParser(
        prog='git upstream',
        version='git-upstream 0.6.1',
        description=upstream.__doc__,
        epilog='for more detail, use: git help upstream'
    )

    include_remote_group = parser.add_mutually_exclusive_group()

    # -r|--include-remote
    include_remote_group.add_argument(
        '-r',
        '--include-remote',
        help='include the remote name',
        action='store_true',
        dest='include_remote',
        default=settings.get('git-upstream.include-remote', default=False, as_type=parse_string.as_bool)
    )

    # -R|--no-include-remote
    include_remote_group.add_argument(
        '-R',
        '--no-include-remote',
        help="don't include the remote name",
        action='store_false',
        dest='include_remote'
    )

    # -b|--branch
    parser.add_argument(
        '-b',
        '--branch',
        help='branch to find upstream for'
    )

    upstream_output = upstream.upstream(**vars(parser.parse_args()))
    if upstream_output:
        print upstream_output

if __name__ == '__main__':
    main()
